"use strict";(self.webpackChunkprueba=self.webpackChunkprueba||[]).push([[19],{3870:(b,p,o)=>{o.d(p,{a:()=>h});var c=o(5e3),_=o(6115),f=o(629);let h=(()=>{class s{constructor(t,r){this.router=t,this.authService=r}canActivate(){return this.authService.authenticated().subscribe(t=>(t||this.router.navigate(["/login"]),this.authService.authenticated())),this.authService.authenticated()}}return s.\u0275fac=function(t){return new(t||s)(c.LFG(_.F0),c.LFG(f.e))},s.\u0275prov=c.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},2019:(b,p,o)=>{o.d(p,{g:()=>h});var c=o(5861),_=o(5e3),f=o(7407);let h=(()=>{class s{constructor(t){this.firestore=t}getAll(){return this.firestore.collection("release_types",t=>t.orderBy("type")).valueChanges({idField:"id"})}getAllMatches(t){return this.firestore.collection("release_types",r=>r.orderBy("type").startAt(t).endAt(t+"\uf8ff")).valueChanges({idField:"id"})}getOne(t){return this.firestore.collection("release_types").doc(t).valueChanges({idField:"id"})}getByType(t){return this.firestore.collection("release_types",r=>r.where("type","==",t)).valueChanges({idField:"id"})}setReleaseType(t){this.release_type=t}getReleaseType(){return this.release_type}create(t){var r=this;return(0,c.Z)(function*(){try{return yield r.firestore.collection("release_types").doc(t.doc_id).set(t)}catch(i){return i}})()}update(t){var r=this;return(0,c.Z)(function*(){try{return yield r.firestore.collection("release_types").doc(t.doc_id).update(Object.assign({},t))}catch(i){return i}})()}delete(t){var r=this;return(0,c.Z)(function*(){try{return yield r.firestore.collection("release_types").doc(t).delete()}catch(i){return i}})()}}return s.\u0275fac=function(t){return new(t||s)(_.LFG(f.ST))},s.\u0275prov=_.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},7488:(b,p,o)=>{o.d(p,{R:()=>h});var c=o(5861),_=o(5e3),f=o(7407);let h=(()=>{class s{constructor(t){this.firestore=t}getAll(){return this.firestore.collection("releases",t=>t.orderBy("title")).valueChanges({idField:"id"})}getAllMatches(t){return this.firestore.collection("releases",r=>r.orderBy("title").startAt(t).endAt(t+"\uf8ff")).valueChanges({idField:"id"})}getOne(t){return this.firestore.collection("releases").doc(t).valueChanges({idField:"id"})}setRelease(t){this.release=t}getRelease(){return this.release}create(t){var r=this;return(0,c.Z)(function*(){try{return yield r.firestore.collection("releases").doc(t.id).set(t)}catch(i){return i}})()}update(t){var r=this;return(0,c.Z)(function*(){try{return yield r.firestore.collection("releases").doc(t.id).update(Object.assign({},t))}catch(i){return i}})()}delete(t){var r=this;return(0,c.Z)(function*(){try{return yield r.firestore.collection("releases").doc(t).delete()}catch(i){return i}})()}}return s.\u0275fac=function(t){return new(t||s)(_.LFG(f.ST))},s.\u0275prov=_.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},1411:(b,p,o)=>{o.d(p,{e:()=>h});var c=o(5861),_=o(5e3),f=o(7407);let h=(()=>{class s{constructor(t){this.firestore=t}getAll(){return this.firestore.collection("songs",t=>t.orderBy("title")).valueChanges({idField:"id"})}getAllMatches(t){return this.firestore.collection("songs",r=>r.orderBy("title").startAt(t).endAt(t+"\uf8ff")).valueChanges({idField:"id"})}getOne(t){return this.firestore.collection("songs").doc(t).valueChanges({idField:"id"})}getByArtist(t){return this.firestore.collection("songs",r=>r.where("release.artist.username","==",t).limit(5)).valueChanges({idField:"id"})}setSong(t){this.song=t}getSong(){return this.song}playSong(t){this.audio&&this.audio.pause(),this.audio=t,this.audio.currentTime=0,this.audio.play()}pauseSong(){this.audio&&this.audio.pause()}create(t){var r=this;return(0,c.Z)(function*(){try{console.log("payload",t);const i=yield r.firestore.collection("songs").doc(t.id).set(t);return console.log("res",i),i}catch(i){return console.log("err",i),i}})()}update(t){var r=this;return(0,c.Z)(function*(){try{return yield r.firestore.collection("songs").doc(t.id).update(Object.assign({},t))}catch(i){return i}})()}delete(t){var r=this;return(0,c.Z)(function*(){try{return yield r.firestore.collection("songs").doc(t).delete()}catch(i){return i}})()}}return s.\u0275fac=function(t){return new(t||s)(_.LFG(f.ST))},s.\u0275prov=_.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},9019:(b,p,o)=>{o.r(p),o.d(p,{NuevaCancionModule:()=>P});var c=o(9808),_=o(5861),f=o(1042),h=o(5226),s=o.n(h),e=o(5e3),t=o(2382),r=o(629),i=o(3632),A=o(1411),O=o(7488),Z=o(2019),l=o(1962),u=o(6115);function C(g,y){if(1&g&&(e.TgZ(0,"div",24)(1,"div",25)(2,"div",26)(3,"div",27)(4,"div",15)(5,"strong",28),e._uU(6),e.qZA()(),e.TgZ(7,"div",29)(8,"strong",28),e._uU(9),e.qZA()()()()()()),2&g){const n=y.$implicit,a=y.index;e.xp6(6),e.hij("#",a+1,""),e.xp6(3),e.Oqu(n.title)}}function T(g,y){if(1&g){const n=e.EpF();e.TgZ(0,"div",3)(1,"main")(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"input",8),e.NdJ("change",function(d){return e.CHM(n),e.oxw().onUploadImg(d)}),e.qZA(),e.TgZ(7,"label",9),e._UZ(8,"img",10),e.qZA()(),e.TgZ(9,"div",11)(10,"label",12)(11,"b"),e._uU(12,"T\xedtulo"),e.qZA()(),e.TgZ(13,"input",13),e.NdJ("ngModelChange",function(d){return e.CHM(n),e.oxw().releaseTitle=d}),e.qZA()()()()(),e.TgZ(14,"div",14),e._UZ(15,"div",15),e.TgZ(16,"div",16),e._UZ(17,"hr",17),e.YNc(18,C,10,2,"div",18),e.TgZ(19,"div",19)(20,"button",20),e.NdJ("click",function(){return e.CHM(n),e.oxw().newSong()}),e._uU(21," A\xf1adir Canci\xf3n "),e.qZA()()()(),e.TgZ(22,"div",21)(23,"button",22),e.NdJ("click",function(){return e.CHM(n),e.oxw().goTo("")}),e._uU(24,"Cancelar"),e.qZA(),e.TgZ(25,"button",23),e.NdJ("click",function(){return e.CHM(n),e.oxw().submit()}),e._uU(26,"Realizar lanzamiento"),e.qZA()()()()}if(2&g){const n=e.oxw();e.xp6(8),e.s9C("src",n.foto,e.LSH),e.xp6(5),e.Q6J("ngModel",n.releaseTitle),e.xp6(5),e.Q6J("ngForOf",n.canciones)}}function M(g,y){if(1&g){const n=e.EpF();e.TgZ(0,"div")(1,"div",30)(2,"main")(3,"div")(4,"div",31)(5,"div",32)(6,"div",33)(7,"div",34)(8,"label",35)(9,"b"),e._uU(10,"T\xedtulo"),e.qZA()(),e.TgZ(11,"input",36),e.NdJ("ngModelChange",function(d){return e.CHM(n),e.oxw().songTitle=d}),e.qZA()(),e.TgZ(12,"div",34)(13,"label",37)(14,"b"),e._uU(15,"Archivo"),e.qZA()(),e.TgZ(16,"input",38),e.NdJ("ngModelChange",function(d){return e.CHM(n),e.oxw().songAudio=d})("change",function(d){return e.CHM(n),e.oxw().onUploadMusic(d)}),e.qZA()()(),e.TgZ(17,"div",39)(18,"button",22),e.NdJ("click",function(){return e.CHM(n),e.oxw().cancel()}),e._uU(19,"Cancelar"),e.qZA(),e.TgZ(20,"button",23),e.NdJ("click",function(){return e.CHM(n),e.oxw().addSong()}),e._uU(21,"Subir canci\xf3n"),e.qZA()()()()()()()()}if(2&g){const n=e.oxw();e.xp6(11),e.Q6J("ngModel",n.songTitle),e.xp6(5),e.Q6J("ngModel",n.songAudio)}}const D=[{path:"",component:(()=>{class g{constructor(n,a,d,v,m,S,x,w){this.formBuilder=n,this.authSrv=a,this.usuarioSrv=d,this.cancionSrv=v,this.releaseSrv=m,this.releaseTypeSrv=S,this.storageSrv=x,this.router=w,this.view="release",this.canciones=[],this.prueba=[]}ngOnInit(){this.foto="https://firebasestorage.googleapis.com/v0/b/samesouls-a0c25.appspot.com/o/portadas%2Fdefault-cover-art.png?alt=media&token=bcb81ed2-8616-4704-a407-cccaed8f388e&_gl=1*1illzu0*_ga*MjEyNDUxODY3Ny4xNjY2MzY4MTYz*_ga_CW55HF8NVT*MTY4NTg3MDY4NC40Mi4xLjE2ODU4NzA4MDAuMC4wLjA.",this.releaseTypeSrv.getAll().subscribe(n=>this.releaseTypes=n)}ngOnDestroy(){}goTo(n){this.router.navigate([n])}logout(){var n=this;return(0,_.Z)(function*(){yield n.authSrv.logout().then(()=>{console.log(n.authSrv.getUsuario())}),n.router.navigate(["/login"])})()}follow(){}onUploadImg(n){let a=n.target.files[0],d=new FileReader;d.readAsDataURL(a),d.onloadend=()=>{this.foto=d.result}}onUploadMusic(n){this.music=n.target.files[0];let a=new FileReader;a.readAsDataURL(this.music),a.onloadend=()=>{}}submit(){var n=this;return(0,_.Z)(function*(){try{let a=n.usuarioSrv.getUsuario();n.storageSrv.uploadImg("portadas/release/"+a.email,n.releaseTitle,n.foto).then(function(){var d=(0,_.Z)(function*(v){if(n.releaseType=1==n.canciones.length?n.releaseTypes.filter(m=>"SINGLE"==m.type)[0]:n.canciones.length>1&&n.canciones.length<8?n.releaseTypes.filter(m=>"EP"==m.type)[0]:n.canciones.length>8?n.releaseTypes.filter(m=>"ALBUM"==m.type)[0]:null,n.myuuid=(0,f.Z)(),n.releaseType){let m={id:n.myuuid,photo:v||n.foto,title:n.releaseTitle,release_type:n.releaseType,artist:a,created_at:(new Date).getTime()};yield n.releaseSrv.create(m),n.canciones.forEach(function(){var S=(0,_.Z)(function*(x){n.storageSrv.uploadMusic(a.email+"/"+n.releaseTitle,x.title,x.audio).then(function(){var w=(0,_.Z)(function*(E){let F;console.log("url",E),console.log("element",x),n.myuuid=(0,f.Z)(),console.log("myuuid",n.myuuid),F={id:n.myuuid,title:x.title,release:m,audio:E,created_at:(new Date).getTime()},console.log("cancion",F),yield n.cancionSrv.create(F)});return function(E){return w.apply(this,arguments)}}())});return function(x){return S.apply(this,arguments)}}()),n.router.navigate(["/artistas/"+a.id])}else s().fire({icon:"error",title:"No se ha a\xf1adido ninguna canci\xf3n"})});return function(v){return d.apply(this,arguments)}}())}catch(a){}})()}newSong(){this.view="song"}addSong(){this.nSong={title:this.songTitle,audio:this.music},this.canciones.push(this.nSong),this.songTitle="",this.songAudio="",this.view="release"}cancel(){this.songTitle="",this.songAudio="",this.view="release"}}return g.\u0275fac=function(n){return new(n||g)(e.Y36(t.qu),e.Y36(r.e),e.Y36(i.L),e.Y36(A.e),e.Y36(O.R),e.Y36(Z.g),e.Y36(l.V),e.Y36(u.F0))},g.\u0275cmp=e.Xpm({type:g,selectors:[["app-nueva-cancion"]],decls:3,vars:2,consts:[[1,"form-signin","needs-validation"],["class","form-back bg-size",4,"ngIf"],[4,"ngIf"],[1,"form-back","bg-size"],[1,"row","mx-auto"],[1,"col-lg-10","mx-auto","py-md-5"],[1,"test","mt-3","d-flex","align-items-center","row","row-cols-1","row-cols-sm-2","row-cols-md-3","g-1"],[1,"col-lg-2"],["name","foto","type","file","accept",".png, .jpg,.jpeg","multiple","","id","inputFile",3,"change"],["for","inputFile",1,"labelInputFile"],["alt","upload file",2,"object-fit","cover",3,"src"],[1,"col-lg-10"],["for","releaseTitle",1,"form-label","text-pink","title-new-song"],["name","releaseTitle","type","text","id","releaseTitle","placeholder","","value","",1,"form-control",3,"ngModel","ngModelChange"],[1,"row-custom","mx-auto"],[1,"col-lg-1"],[1,"col-lg-10","mx-auto"],[1,"text-pink"],["class","col mt-music-panel mb-2",4,"ngFor","ngForOf"],[1,"mt-5","mb-5","d-flex","justify-content-center","align-items-center"],[1,"btn","btn-light",3,"click"],[1,"col-10","mx-auto","d-flex","justify-content-end","mt-5"],[1,"btn","btn-outline-light","me-3",3,"click"],[1,"btn","btn-light","me-4",3,"click"],[1,"col","mt-music-panel","mb-2"],[1,"shadow-sm"],[1,"card-body","card-back","padding-btw-col","border-music-panel"],[1,"row","row-cols-1","row-cols-sm-4","row-cols-md-4","g-3","song-selector"],[1,"text-pink","no-salir"],[1,"col-lg-4","d-flex","align-items-center"],[1,"form-back","bg-dark"],[1,"col-lg-10","mx-auto","p-3","py-md-5"],[1,"test","mt-3","d-flex","align-items-center","justify-content-center","row","g-1"],[1,"row","row-cols-2","col-lg-12"],[1,"col-6"],["for","songTitle",1,"form-label","text-pink","title-new-song"],["name","songTitle","type","text","id","songTitle","placeholder","","value","",1,"form-control",3,"ngModel","ngModelChange"],["for","inputSong",1,"form-label","text-pink","title-new-song"],["name","cancion","type","file","accept",".mp3, .wav","id","inputSong",1,"form-control",3,"ngModel","ngModelChange","change"],[1,"col-12","d-flex","justify-content-end","mt-5"]],template:function(n,a){1&n&&(e.TgZ(0,"form",0),e.YNc(1,T,27,3,"div",1),e.YNc(2,M,22,2,"div",2),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf","release"==a.view),e.xp6(1),e.Q6J("ngIf","song"==a.view))},directives:[t._Y,t.JL,t.F,c.O5,t.Fj,t.JJ,t.On,c.sg],styles:[".name[_ngcontent-%COMP%]{font-size:450%;color:#ab6c6c;margin-left:5%}.title-new-song[_ngcontent-%COMP%]{font-size:125%}.test[_ngcontent-%COMP%]{max-width:100%}.arreglo[_ngcontent-%COMP%]{margin-top:25px;width:100%}.btn-back[_ngcontent-%COMP%]{background-color:#ab6c6c;border-radius:20px}.info[_ngcontent-%COMP%]{padding:30px}.color-link[_ngcontent-%COMP%]{color:#ab6c6c}.div-pointer[_ngcontent-%COMP%]{text-align:center;width:50%;cursor:pointer}.bg-profile[_ngcontent-%COMP%]{background-image:url(https://firebasestorage.googleapis.com/v0/b/boomclub-tfg.appspot.com/o/backOG3.png?alt=media&token=07ca8e3a-0ce0-49a8-95d6-4a8c2add230d);background-size:cover}#inputFile[_ngcontent-%COMP%]{display:none}.labelInputFile[_ngcontent-%COMP%]{width:200px;height:200px;padding:1rem;box-shadow:0 0 10px -1px gray;display:flex;justify-content:center;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none}.labelInputFile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px;height:200px}.labelInputFile[_ngcontent-%COMP%]:active{transform:scale(.9)}@media screen and (max-width: 767px){.ocultar[_ngcontent-%COMP%]{display:none}}"]}),g})(),canActivate:[o(3870).a],pathMatch:"full"}];let P=(()=>{class g{}return g.\u0275fac=function(n){return new(n||g)},g.\u0275mod=e.oAB({type:g}),g.\u0275inj=e.cJS({imports:[[c.ez,t.u5,t.UX,u.Bz.forChild(D)],u.Bz]}),g})()},1042:(b,p,o)=>{o.d(p,{Z:()=>Z});var c,_=new Uint8Array(16);function f(){if(!c&&!(c="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(_)}const h=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,e=function s(l){return"string"==typeof l&&h.test(l)};for(var t=[],r=0;r<256;++r)t.push((r+256).toString(16).substr(1));const Z=function O(l,u,C){var T=(l=l||{}).random||(l.rng||f)();if(T[6]=15&T[6]|64,T[8]=63&T[8]|128,u){C=C||0;for(var M=0;M<16;++M)u[C+M]=T[M];return u}return function i(l){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,C=(t[l[u+0]]+t[l[u+1]]+t[l[u+2]]+t[l[u+3]]+"-"+t[l[u+4]]+t[l[u+5]]+"-"+t[l[u+6]]+t[l[u+7]]+"-"+t[l[u+8]]+t[l[u+9]]+"-"+t[l[u+10]]+t[l[u+11]]+t[l[u+12]]+t[l[u+13]]+t[l[u+14]]+t[l[u+15]]).toLowerCase();if(!e(C))throw TypeError("Stringified UUID is invalid");return C}(T)}}}]);